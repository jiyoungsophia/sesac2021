# ğŸŸ¢ Day21 TIL - 211027 ğŸŸ¢

â–¶ï¸ [Pagination](#ï¸-pagination)

â–¶ï¸ [êµ¬í˜„ë°©ë²•](#ï¸-êµ¬í˜„ë°©ë²•)




***

<br>

## âœ”ï¸ Pagination

* OffsetPagenation: `QueryString`ì— ë³´ì—¬ì¤„ í˜ì´ì§€ì™€ ë°ì´í„°ì˜ ê°¯ìˆ˜ë¥¼ ì „
* CursorPagenation: í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ì§€ê³  ìˆëŠ” ë§ˆì§€ë§‰ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒ ë°ì´í„°ë¥¼ ì¡°íšŒ
  * í˜„ì¬ í˜ì´ì§€ ê¸°ì¤€ìœ¼ë¡œ ì „, í›„ ë°ì´í„°ë¥¼ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì— ì •ë³´ë¥¼ ê±´ë„ˆëŒ ìˆ˜ ì—†ìŒ

<br>

<br>

## âœ”ï¸ êµ¬í˜„ë°©ë²•

* TableView willDisplayCell Method(í…Œì´ë¸” ë·°ê°€ íŠ¹ì •ì…€ì„ ê·¸ë¦¬ë ¤ëŠ” ì‹œì ì— í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜)
  * í•¨ìˆ˜ê°€ ë¶ˆë¦¬ëŠ” ì‹œì ì´ í™”ë©´ì— cellì´ ë³´ì¼ ë•Œë¼ëŠ” ê²ƒì„ ë³´ì¥í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ê¶Œì¥í•˜ì§€ ì•ŠìŒ

* UIScrollViewDelegate Protocol - ìŠ¤í¬ë¡¤ë·°ì˜ Offset í™œìš©

  * ìŠ¤í¬ë¡¤ì˜ ë³€í™”ë¥¼ ê°ì§€í•  ìˆ˜ ìˆëŠ” `scrollViewDidScroll` ë¥¼ í™œìš©

  * ë†’ì´ë¥¼ ë¹„êµí•´ ìŠ¤í¬ë¡¤ì„ ë”ì´ìƒ í•  ìˆ˜ ì—†ì„ ë•Œ **addData**

    ```swift
    func scrollViewDidScroll(_ scrollView: UIScrollView) {        
      let height: CGFloat = scrollView.frame.size.height            
      let contentYOffset: CGFloat = scrollView.contentOffset.y            
      let scrollViewHeight: CGFloat = scrollView.contentSize.height            
      let distanceFromBottom: CGFloat = scrollViewHeight - contentYOffset
                
      if distanceFromBottom < height {
        self.addData()            
      }
    }
    ```

    

* UITableViewDataSourcePrefetching Protocol

  * ì„œë²„ í†µì‹ ê³¼ ê°™ì€ ë¹„ë™ê¸° ìƒí™©ì—ì„œ ì‰½ê²Œ paginationì„ êµ¬í˜„í•  ìˆ˜ ìˆê³ ,
  * ìš©ëŸ‰ì´ í° ë°ì´í„°ê°™ì´ ë¶€ë‹´ë  ìˆ˜ ìˆëŠ” ì‘ì—…ì— íš¨ê³¼ì 

  ```swift
  // ëŒ€ë¦¬ììœ„ì„
  searchTableView.prefetchDataSource = self
  
  func tableView(_ tableView: UITableView, prefetchRowsAt indexPaths: [IndexPath]) {
    for indexPath in indexPaths {
      if dataList.count == indexPath.row {
        self.addData()
      }
    }
  }
  ```

  * í™œìš©

  ```swift
  var startPage = 1
  
  // UITableViewDataSourcePrefetching
  func tableView(_ tableView: UITableView, prefetchRowsAt indexPaths: [IndexPath]) {
          for indexPath in indexPaths {
              // ì‚¬ìš©ìê°€ ë³´ê³ ìˆëŠ” ì…€ì´ ê°€ì¥ ë§ˆì§€ë§‰ ì…€ì´ë©´
              if movieData.count - 1 == indexPath.row && movieData.count < totalCount {
                  startPage = min(startPage + 10, totalCount)
                  guard let text = searchBar.text else { return }
                  fetchMovieData(query: text)
              }
          }
      }
  
  // ì·¨ì†Œ
      func tableView(_ tableView: UITableView, cancelPrefetchingForRowsAt indexPaths: [IndexPath]) {
          print("ì·¨ì†Œ: \(indexPaths)")
      }
  ```

<br>

<br>

